<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Level API - Geometry Dash Level Tracker</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: monospace;
            white-space: pre;
            background: #1e1e1e;
            color: #d4d4d4;
        }
    </style>
</head>
<body>
    <script>
        // Get query parameters from URL
        const urlParams = new URLSearchParams(window.location.search);
        const levelName = urlParams.get('name');
        const levelId = urlParams.get('id');
        const exact = urlParams.get('exact') === 'true';
        
        // Load levels data
        async function loadAndReturnLevel() {
            try {
                const response = await fetch('levels.json');
                if (!response.ok) {
                    throw new Error('Failed to load levels data');
                }
                const levelsData = await response.json();
                
                let result = null;
                
                // Search by name
                if (levelName) {
                    const searchName = levelName.toLowerCase().trim();
                    if (exact) {
                        // Exact match
                        result = levelsData.find(level => 
                            level.name.toLowerCase() === searchName
                        );
                    } else {
                        // Partial match
                        result = levelsData.find(level => 
                            level.name.toLowerCase().includes(searchName)
                        );
                    }
                }
                // Search by ID
                else if (levelId) {
                    const searchId = parseInt(levelId);
                    if (isNaN(searchId)) {
                        throw new Error('Invalid ID format');
                    }
                    result = levelsData.find(level => level.id === searchId);
                } else {
                    // No parameters - return error
                    const error = {
                        error: 'Missing parameter',
                        message: 'Please provide either "name" or "id" parameter',
                        example: {
                            byName: window.location.origin + window.location.pathname + '?name=Stereo%20Madness',
                            byId: window.location.origin + window.location.pathname + '?id=1',
                            exactMatch: window.location.origin + window.location.pathname + '?name=Stereo%20Madness&exact=true'
                        }
                    };
                    document.body.textContent = JSON.stringify(error, null, 2);
                    return;
                }
                
                // Return JSON response
                if (result) {
                    // Return the level object
                    document.body.textContent = JSON.stringify(result, null, 2);
                } else {
                    // Return error if not found
                    const error = {
                        error: 'Level not found',
                        message: levelName 
                            ? `No level found with name ${exact ? 'matching' : 'containing'} "${levelName}"`
                            : `No level found with ID "${levelId}"`
                    };
                    document.body.textContent = JSON.stringify(error, null, 2);
                }
            } catch (error) {
                const errorResponse = {
                    error: 'Failed to load data',
                    message: error.message
                };
                document.body.textContent = JSON.stringify(errorResponse, null, 2);
            }
        }
        
        // Load and return the level
        loadAndReturnLevel();
    </script>
</body>
</html>

